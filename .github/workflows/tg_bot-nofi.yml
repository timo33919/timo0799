name: CI Workflow with Telegram Notification

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Run tests
        run: echo "Running tests..."

      - name: Notify Telegram
        if: always()
        run: |
          STATUS="${{ job.status }}"
          CONCLUSION="${{ job.conclusion }}"
          MESSAGE="Workflow status: $STATUS\nConclusion: $CONCLUSION\nRepository: $GITHUB_REPOSITORY\nWorkflow: $GITHUB_WORKFLOW\nView logs: $GITHUB_SERVER_URL/$GITHUB_REPOSITORY/actions/runs/$GITHUB_RUN_ID"

          curl -s -X POST https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage \
            -d chat_id=${{ secrets.TELEGRAM_CHAT_ID }} \
            -d text="$MESSAGE"
